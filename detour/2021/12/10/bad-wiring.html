<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <title>Bad Wiring</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="stylesheet" type="text/css" href="/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="https://assumeforsimplicity.com/feed.xml" title="Assume For Simplicity" />
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Bad Wiring | Assume For Simplicity</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Bad Wiring" />
<meta name="author" content="jr101dallas" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Puzzling This puzzle has to do with randomized code breaking. At least that’s my interpretation of it. The basic idea is that the wires have gotten scrambled, and the output isn’t displaying what ought to be displaying. You get what the display is, and you get a series of statements on signals you get on the wires, and you need to decipher what the display should say." />
<meta property="og:description" content="Puzzling This puzzle has to do with randomized code breaking. At least that’s my interpretation of it. The basic idea is that the wires have gotten scrambled, and the output isn’t displaying what ought to be displaying. You get what the display is, and you get a series of statements on signals you get on the wires, and you need to decipher what the display should say." />
<link rel="canonical" href="https://assumeforsimplicity.com/detour/2021/12/10/bad-wiring.html" />
<meta property="og:url" content="https://assumeforsimplicity.com/detour/2021/12/10/bad-wiring.html" />
<meta property="og:site_name" content="Assume For Simplicity" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-10T09:11:34+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bad Wiring" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"jr101dallas"},"description":"Puzzling This puzzle has to do with randomized code breaking. At least that’s my interpretation of it. The basic idea is that the wires have gotten scrambled, and the output isn’t displaying what ought to be displaying. You get what the display is, and you get a series of statements on signals you get on the wires, and you need to decipher what the display should say.","headline":"Bad Wiring","dateModified":"2021-12-10T09:11:34+00:00","url":"https://assumeforsimplicity.com/detour/2021/12/10/bad-wiring.html","datePublished":"2021-12-10T09:11:34+00:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://assumeforsimplicity.com/detour/2021/12/10/bad-wiring.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <div id="container">
      <div class="inner">
        <nav>
    
      <a href="/" >
        Home
      </a>
    
      <a href="/posts/" >
        Posts
      </a>
    
      <a href="/breadcrumbs/" >
        Breadcrumbs
      </a>
    
      <a href="/roguelike-tutorial/" >
        Roguelike
      </a>
    
      <a href="/about/" >
        About
      </a>
    
  </nav>
        <header>
          <h1>Bad Wiring</h1>
          <h2>Manage Time, Software, and Business, Easily  </h2>
        </header>
        <section id="downloads" class="clearfix">
          
	
        </section>
        <hr>
        <section id="main_content">
          <p class="view">10 December 2021 by jr101dallas</p>
<a href="/posts/">&#8672;&nbsp;Back to Posts</a>


<h1 id="puzzling">Puzzling</h1>
<p>This puzzle has to do with randomized code breaking. At least that’s my interpretation of it. The basic idea is that the wires have gotten scrambled, and the output isn’t displaying what ought to be displaying. You get what the display is, and you get a series of statements on signals you get on the wires, and you need to decipher what the display should say.</p>

<h2 id="truth-tables">Truth Tables</h2>
<p>I thought that my best move was to define the rules literally into some tables so I can do some joins and get my answers. But, I actually ended up with a pile of variables and logic to decipher. Here’s my data insert.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span><span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">NULL</span><span class="p">))</span> <span class="k">AS</span> <span class="n">rowNum</span><span class="p">,</span>
	<span class="n">w1</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w1</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w1l</span><span class="p">,</span>
	<span class="n">w2</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w2</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w2l</span><span class="p">,</span>
	<span class="n">w3</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w3</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w3l</span><span class="p">,</span>
	<span class="n">w4</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w4</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w4l</span><span class="p">,</span>
	<span class="n">w5</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w5</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w5l</span><span class="p">,</span>
	<span class="n">w6</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w6</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w6l</span><span class="p">,</span>
	<span class="n">w7</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w7</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w7l</span><span class="p">,</span>
	<span class="n">w8</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w8</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w8l</span><span class="p">,</span>
	<span class="n">w9</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w9</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w9l</span><span class="p">,</span>
	<span class="n">w10</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">w10</span><span class="p">)</span> <span class="k">AS</span> <span class="n">w10l</span><span class="p">,</span>
	<span class="n">a</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">AS</span> <span class="n">al</span><span class="p">,</span>
	<span class="n">b</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">AS</span> <span class="n">bl</span><span class="p">,</span>
	<span class="k">c</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="k">c</span><span class="p">)</span> <span class="k">AS</span> <span class="n">cl</span><span class="p">,</span>
	<span class="n">d</span><span class="p">,</span> <span class="n">LEN</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">AS</span> <span class="n">dl</span>
<span class="k">INTO</span> <span class="n">WiresAndDisplays</span>
<span class="k">FROM</span> <span class="p">(</span>
<span class="k">VALUES</span>
<span class="p">(</span><span class="s1">'fcdeba'</span><span class="p">,</span><span class="s1">'edcbag'</span><span class="p">,</span><span class="s1">'decab'</span><span class="p">,</span><span class="s1">'adcefg'</span><span class="p">,</span><span class="s1">'acdfb'</span><span class="p">,</span><span class="s1">'gdcfb'</span><span class="p">,</span><span class="s1">'acf'</span><span class="p">,</span><span class="s1">'fabe'</span><span class="p">,</span><span class="s1">'fa'</span><span class="p">,</span><span class="s1">'eacfgbd'</span><span class="p">,</span><span class="s1">'aefb'</span><span class="p">,</span><span class="s1">'cfa'</span><span class="p">,</span><span class="s1">'acf'</span><span class="p">,</span><span class="s1">'cdabf'</span><span class="p">),</span>
<span class="p">(</span><span class="s1">'adbec'</span><span class="p">,</span><span class="s1">'fabeg'</span><span class="p">,</span><span class="s1">'fgda'</span><span class="p">,</span><span class="s1">'gafedb'</span><span class="p">,</span><span class="s1">'fadeb'</span><span class="p">,</span><span class="s1">'cdebgf'</span><span class="p">,</span><span class="s1">'cfaebdg'</span><span class="p">,</span><span class="s1">'fd'</span><span class="p">,</span><span class="s1">'bdf'</span><span class="p">,</span><span class="s1">'cgfbae'</span><span class="p">,</span><span class="s1">'ebdfga'</span><span class="p">,</span><span class="s1">'fbd'</span><span class="p">,</span><span class="s1">'bdagcef'</span><span class="p">,</span><span class="s1">'dfb'</span><span class="p">),</span>
<span class="p">...</span>
<span class="p">(</span><span class="s1">'eg'</span><span class="p">,</span><span class="s1">'dgaebc'</span><span class="p">,</span><span class="s1">'dfcgab'</span><span class="p">,</span><span class="s1">'cdgfe'</span><span class="p">,</span><span class="s1">'edfcb'</span><span class="p">,</span><span class="s1">'adcgf'</span><span class="p">,</span><span class="s1">'cedagf'</span><span class="p">,</span><span class="s1">'geaf'</span><span class="p">,</span><span class="s1">'bacdefg'</span><span class="p">,</span><span class="s1">'gde'</span><span class="p">,</span><span class="s1">'dfcbe'</span><span class="p">,</span><span class="s1">'eagf'</span><span class="p">,</span><span class="s1">'agdecf'</span><span class="p">,</span><span class="s1">'ge'</span><span class="p">)</span>
<span class="p">)</span> <span class="n">t</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">w3</span><span class="p">,</span><span class="n">w4</span><span class="p">,</span><span class="n">w5</span><span class="p">,</span><span class="n">w6</span><span class="p">,</span><span class="n">w7</span><span class="p">,</span><span class="n">w8</span><span class="p">,</span><span class="n">w9</span><span class="p">,</span><span class="n">w10</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="k">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>
</code></pre></div></div>

<p>I knew from reading the first puzzle that I was going to need the lengths of the combinations, so the insert is a bit more complicated in order to get all the lengths calculated from the beginning. It’s a little silly on the 28 columns, but when I do my processing I’ll eventually take it one row (set) at a time.</p>

<p>The good thing is, that by going the lengths as part of the insert, puzzle one is complete with a single query.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WITH</span> <span class="n">segmentCounts</span> <span class="k">AS</span> <span class="p">(</span>
<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="p">(</span>
	<span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">)</span> <span class="n">t</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">segCount</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">t</span><span class="p">.</span><span class="n">val</span> <span class="k">IN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">s1</span><span class="p">.</span><span class="n">segCount</span><span class="p">)</span> <span class="k">AS</span> <span class="n">aCnt</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">s2</span><span class="p">.</span><span class="n">segCount</span><span class="p">)</span> <span class="k">AS</span> <span class="n">bCnt</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">s3</span><span class="p">.</span><span class="n">segCount</span><span class="p">)</span> <span class="k">AS</span> <span class="n">cCnt</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="n">s4</span><span class="p">.</span><span class="n">segCount</span><span class="p">)</span> <span class="k">AS</span> <span class="n">dCnt</span>
<span class="k">FROM</span> <span class="n">wiresanddisplays</span> <span class="n">w</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">segmentCounts</span> <span class="n">s1</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">al</span> <span class="o">=</span> <span class="n">s1</span><span class="p">.</span><span class="n">segCount</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">segmentCounts</span> <span class="n">s2</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">bl</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">segCount</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">segmentCounts</span> <span class="n">s3</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">cl</span> <span class="o">=</span> <span class="n">s3</span><span class="p">.</span><span class="n">segCount</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">segmentCounts</span> <span class="n">s4</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">dl</span> <span class="o">=</span> <span class="n">s4</span><span class="p">.</span><span class="n">segCount</span>
</code></pre></div></div>

<p>True, I didn’t do the acrobatics to go one more step and add the aCnt, bCnt, etc. values but if I really need to do that for puzzle two then I will. For now I just copied the result set, put select in front and plus signs between and run it to get my answer.</p>

<h2 id="puzzle-two">Puzzle Two</h2>
<p>Ok, now is the logic heavy part. I usually build my loop logic as a single iteration first and then build in the loop, so this is how far I got when I saw I had a problem. First I decided that I’d rather deal with the data sets pivoted.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">WireAndDisplayPivot</span> <span class="p">(</span><span class="n">rowNum</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">combo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">comboLen</span> <span class="nb">INT</span><span class="p">)</span>

<span class="k">WITH</span> <span class="n">cte</span> <span class="k">AS</span> <span class="p">(</span>
	<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span>
		<span class="n">w1</span><span class="p">,</span><span class="n">w1l</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">w2l</span><span class="p">,</span><span class="n">w3</span><span class="p">,</span><span class="n">w3l</span><span class="p">,</span><span class="n">w4</span><span class="p">,</span><span class="n">w4l</span><span class="p">,</span><span class="n">w5</span><span class="p">,</span><span class="n">w5l</span><span class="p">,</span><span class="n">w6</span><span class="p">,</span><span class="n">w6l</span><span class="p">,</span><span class="n">w7</span><span class="p">,</span><span class="n">w7l</span><span class="p">,</span><span class="n">w8</span><span class="p">,</span><span class="n">w8l</span><span class="p">,</span><span class="n">w9</span><span class="p">,</span><span class="n">w9l</span><span class="p">,</span><span class="n">w10</span><span class="p">,</span><span class="n">w10l</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">al</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">bl</span><span class="p">,</span><span class="k">c</span><span class="p">,</span><span class="n">cl</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">dl</span>
	<span class="k">FROM</span> <span class="n">wiresanddisplays</span>
	<span class="c1">--WHERE rowNum = 1</span>
<span class="p">)</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">WireAndDisplayPivot</span> <span class="p">(</span><span class="n">rowNum</span> <span class="p">,</span> <span class="n">combo</span> <span class="p">,</span> <span class="n">comboLen</span> <span class="p">)</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w1</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w1l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span> 
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w2</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w2l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w3</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w3l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w4</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w4l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w5</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w5l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w6</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w6l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w7</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w7l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w8</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w8l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w9</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w9l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">rowNum</span><span class="p">,</span> <span class="n">w10</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="n">w10l</span> <span class="k">AS</span> <span class="n">comboLen</span> <span class="k">FROM</span> <span class="n">cte</span><span class="p">;</span>
</code></pre></div></div>

<p>Then I put together this logic for the deciphering.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DECLARE</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">TABLE</span><span class="p">(</span><span class="n">rowNum</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">combo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">comboLen</span> <span class="nb">INT</span><span class="p">)</span>
<span class="k">DECLARE</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="k">TABLE</span><span class="p">(</span><span class="n">digit</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">combo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="k">DECLARE</span> <span class="o">@</span><span class="n">OneCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">TwoCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">ThreeCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">FourCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">FiveCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">SixCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">SevenCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">EightCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">NineCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">ZeroCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">RightWireOne</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">RightWireTwo</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">MiddleAndUpperLeft</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">Middle</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">UpperLeft</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">TestSet</span>
<span class="k">SELECT</span> <span class="o">*</span> 
<span class="k">FROM</span> <span class="n">WireAndDisplayPivot</span>
<span class="k">WHERE</span> <span class="n">rowNum</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">OneCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">SELECT</span> <span class="o">@</span><span class="n">FourCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">4</span>
<span class="k">SELECT</span> <span class="o">@</span><span class="n">SevenCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">SELECT</span> <span class="o">@</span><span class="n">EightCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">7</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">RightWireOne</span> <span class="o">=</span> <span class="k">LEFT</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="o">@</span><span class="n">RightWireTwo</span> <span class="o">=</span> <span class="k">RIGHT</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">MiddleAndUpperLeft</span> <span class="o">=</span> <span class="k">REPLACE</span><span class="p">(</span>
			<span class="k">REPLACE</span><span class="p">(</span>
				<span class="o">@</span><span class="n">FourCombo</span>
			<span class="p">,</span> <span class="o">@</span><span class="n">RightWireOne</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
		<span class="p">,</span> <span class="o">@</span><span class="n">RightWireTwo</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">=</span> <span class="k">LEFT</span><span class="p">(</span><span class="o">@</span><span class="n">MiddleAndUpperLeft</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="o">=</span> <span class="k">RIGHT</span><span class="p">(</span><span class="o">@</span><span class="n">MiddleAndUpperLeft</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">NineCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">6</span> 
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">RightWireOne</span> <span class="o">+</span> <span class="s1">'%'</span> 
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">RightWireTwo</span> <span class="o">+</span> <span class="s1">'%'</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">+</span> <span class="s1">'%'</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="o">+</span> <span class="s1">'%'</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">SixCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">6</span> 
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">+</span> <span class="s1">'%'</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="o">+</span> <span class="s1">'%'</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">NineCombo</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">ZeroCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">6</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">NineCombo</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">SixCombo</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">Middle</span> <span class="o">=</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="o">@</span><span class="n">ZeroCombo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">THEN</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="k">ELSE</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="k">END</span><span class="p">,</span>
	<span class="o">@</span><span class="n">UpperLeft</span> <span class="o">=</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="o">@</span><span class="n">ZeroCombo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">THEN</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="k">ELSE</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="k">END</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">FiveCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">5</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">UpperLeft</span> <span class="o">+</span> <span class="s1">'%'</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">ThreeCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">5</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">RightWireOne</span> <span class="o">+</span> <span class="s1">'%'</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">RightWireTwo</span> <span class="o">+</span> <span class="s1">'%'</span>

<span class="k">SELECT</span> <span class="o">@</span><span class="n">TwoCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">5</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">FiveCombo</span>
	<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">ThreeCombo</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">DigitsToCombos</span>
<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="p">(</span>
	<span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">ZeroCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">@</span><span class="n">OneCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">@</span><span class="n">TwoCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">@</span><span class="n">ThreeCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">@</span><span class="n">FourCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">@</span><span class="n">FiveCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">@</span><span class="n">SixCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">@</span><span class="n">SevenCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">@</span><span class="n">EightCombo</span><span class="p">),</span>
		<span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="o">@</span><span class="n">NineCombo</span><span class="p">)</span>
<span class="p">)</span> <span class="n">t</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">combo</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="n">w</span><span class="p">.</span><span class="o">*</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">digit</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">digit</span><span class="p">,</span> <span class="k">c</span><span class="p">.</span><span class="n">digit</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">digit</span>
<span class="k">FROM</span> <span class="n">WiresAndDisplays</span> <span class="n">w</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="n">a</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">combo</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="n">b</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">combo</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="k">c</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="k">c</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">combo</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="n">d</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">combo</span>
<span class="k">WHERE</span> <span class="n">w</span><span class="p">.</span><span class="n">rowNum</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>But, it doesn’t work. The letter combinations aren’t consistent within the first row. So I’m going to have to do some data scrubbing.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">ALTER</span> <span class="k">FUNCTION</span> <span class="n">LetterToBitConverter</span><span class="p">(</span><span class="o">@</span><span class="n">combo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="k">RETURNS</span> <span class="k">TABLE</span>
<span class="k">RETURN</span>
<span class="k">WITH</span> <span class="k">conversion</span> <span class="k">AS</span> <span class="p">(</span>
	<span class="k">SELECT</span> <span class="n">letter</span><span class="p">,</span> <span class="n">bits</span>
	<span class="k">FROM</span> <span class="p">(</span>
		<span class="k">VALUES</span><span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'b'</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'c'</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'d'</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'e'</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'f'</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">'g'</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
	<span class="p">)</span> <span class="n">v</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">bits</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">SELECT</span> <span class="o">@</span><span class="n">combo</span> <span class="k">AS</span> <span class="n">combo</span><span class="p">,</span> <span class="k">SUM</span><span class="p">(</span><span class="n">bits</span><span class="p">)</span> <span class="k">AS</span> <span class="n">BitSequence</span>
<span class="k">FROM</span> <span class="p">(</span>
	<span class="k">SELECT</span> <span class="n">letter</span><span class="p">,</span> <span class="n">bits</span> <span class="k">FROM</span> <span class="k">conversion</span> <span class="k">WHERE</span> <span class="o">@</span><span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="n">letter</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">AND</span> <span class="n">letter</span> <span class="o">=</span> <span class="s1">'a'</span>
	<span class="k">UNION</span>
	<span class="k">SELECT</span> <span class="n">letter</span><span class="p">,</span> <span class="n">bits</span> <span class="k">FROM</span> <span class="k">conversion</span> <span class="k">WHERE</span> <span class="o">@</span><span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="n">letter</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">AND</span> <span class="n">letter</span> <span class="o">=</span> <span class="s1">'b'</span>
	<span class="k">UNION</span>
	<span class="k">SELECT</span> <span class="n">letter</span><span class="p">,</span> <span class="n">bits</span> <span class="k">FROM</span> <span class="k">conversion</span> <span class="k">WHERE</span> <span class="o">@</span><span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="n">letter</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">AND</span> <span class="n">letter</span> <span class="o">=</span> <span class="s1">'c'</span>
	<span class="k">UNION</span>
	<span class="k">SELECT</span> <span class="n">letter</span><span class="p">,</span> <span class="n">bits</span> <span class="k">FROM</span> <span class="k">conversion</span> <span class="k">WHERE</span> <span class="o">@</span><span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="n">letter</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">AND</span> <span class="n">letter</span> <span class="o">=</span> <span class="s1">'d'</span>
	<span class="k">UNION</span>
	<span class="k">SELECT</span> <span class="n">letter</span><span class="p">,</span> <span class="n">bits</span> <span class="k">FROM</span> <span class="k">conversion</span> <span class="k">WHERE</span> <span class="o">@</span><span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="n">letter</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">AND</span> <span class="n">letter</span> <span class="o">=</span> <span class="s1">'e'</span>
	<span class="k">UNION</span>
	<span class="k">SELECT</span> <span class="n">letter</span><span class="p">,</span> <span class="n">bits</span> <span class="k">FROM</span> <span class="k">conversion</span> <span class="k">WHERE</span> <span class="o">@</span><span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="n">letter</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">AND</span> <span class="n">letter</span> <span class="o">=</span> <span class="s1">'f'</span>
	<span class="k">UNION</span>
	<span class="k">SELECT</span> <span class="n">letter</span><span class="p">,</span> <span class="n">bits</span> <span class="k">FROM</span> <span class="k">conversion</span> <span class="k">WHERE</span> <span class="o">@</span><span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="n">letter</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">AND</span> <span class="n">letter</span> <span class="o">=</span> <span class="s1">'g'</span>
<span class="p">)</span> <span class="n">t</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">bits</span><span class="p">)</span>
<span class="k">GO</span>

<span class="k">SELECT</span> <span class="n">w</span><span class="p">.</span><span class="o">*</span><span class="p">,</span> <span class="n">ca_a</span><span class="p">.</span><span class="n">BitSequence</span> <span class="k">AS</span> <span class="n">BitsA</span><span class="p">,</span> <span class="n">ca_b</span><span class="p">.</span><span class="n">BitSequence</span> <span class="k">AS</span> <span class="n">BitsB</span><span class="p">,</span> <span class="n">ca_c</span><span class="p">.</span><span class="n">BitSequence</span> <span class="k">AS</span> <span class="n">BitsC</span><span class="p">,</span> <span class="n">ca_d</span><span class="p">.</span><span class="n">BitSequence</span> <span class="k">AS</span> <span class="n">BitsD</span>
<span class="k">INTO</span> <span class="n">DisplaysWithBits</span>
<span class="k">FROM</span> <span class="n">WiresAndDisplays</span> <span class="n">w</span>
<span class="k">CROSS</span> <span class="n">APPLY</span> <span class="n">dbo</span><span class="p">.</span><span class="n">LetterToBitConverter</span><span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="n">a</span><span class="p">)</span> <span class="n">ca_a</span>
<span class="k">CROSS</span> <span class="n">APPLY</span> <span class="n">dbo</span><span class="p">.</span><span class="n">LetterToBitConverter</span><span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="n">b</span><span class="p">)</span> <span class="n">ca_b</span>
<span class="k">CROSS</span> <span class="n">APPLY</span> <span class="n">dbo</span><span class="p">.</span><span class="n">LetterToBitConverter</span><span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="k">c</span><span class="p">)</span> <span class="n">ca_c</span>
<span class="k">CROSS</span> <span class="n">APPLY</span> <span class="n">dbo</span><span class="p">.</span><span class="n">LetterToBitConverter</span><span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="n">d</span><span class="p">)</span> <span class="n">ca_d</span>
</code></pre></div></div>

<p>That’s going to get me individual digits so there’s a bit more conversion to do to get the integers so I can just sum them.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">ALTER</span> <span class="k">FUNCTION</span> <span class="n">DigitsToIntConverter</span><span class="p">(</span><span class="o">@</span><span class="k">First</span> <span class="nb">INT</span><span class="p">,</span> <span class="o">@</span><span class="k">Second</span> <span class="nb">INT</span><span class="p">,</span> <span class="o">@</span><span class="n">Third</span> <span class="nb">INT</span><span class="p">,</span> <span class="o">@</span><span class="n">Fourth</span> <span class="nb">INT</span><span class="p">)</span>
<span class="k">RETURNS</span> <span class="k">TABLE</span>
<span class="k">RETURN</span>
<span class="k">SELECT</span> <span class="k">CONVERT</span><span class="p">(</span><span class="nb">INT</span><span class="p">,</span> 
	<span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">@</span><span class="k">First</span><span class="p">)</span> <span class="o">+</span> <span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">@</span><span class="k">Second</span><span class="p">)</span> <span class="o">+</span> <span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">@</span><span class="n">Third</span><span class="p">)</span> <span class="o">+</span> <span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">@</span><span class="n">Fourth</span><span class="p">)</span>
	<span class="p">)</span> <span class="k">AS</span> <span class="n">DisplayNumber</span>
<span class="k">GO</span>
</code></pre></div></div>

<p>That should do it. Here’s my updated logic with the joind on the bit sequences for the combos and the looping logic.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">DigitsToSum</span> <span class="p">(</span><span class="n">rowNum</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">displayNum</span> <span class="nb">INT</span><span class="p">)</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">TABLE</span><span class="p">(</span><span class="n">rowNum</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">combo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">comboLen</span> <span class="nb">INT</span><span class="p">)</span>
<span class="k">DECLARE</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="k">TABLE</span><span class="p">(</span><span class="n">digit</span> <span class="nb">INT</span><span class="p">,</span> <span class="n">combo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">bits</span> <span class="nb">INT</span><span class="p">)</span>
<span class="k">DECLARE</span> <span class="o">@</span><span class="n">Iteration</span> <span class="nb">INT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">@</span><span class="n">RowCount</span> <span class="nb">INT</span> <span class="o">=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">DisplaysWithBits</span><span class="p">),</span>
	<span class="o">@</span><span class="n">OneCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">TwoCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">ThreeCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">FourCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">FiveCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">SixCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">SevenCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">EightCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">NineCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">ZeroCombo</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
	<span class="o">@</span><span class="n">RightWireOne</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">RightWireTwo</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">MiddleAndUpperLeft</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">Middle</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="o">@</span><span class="n">UpperLeft</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">TestSet</span>
<span class="k">SELECT</span> <span class="o">*</span> 
<span class="k">FROM</span> <span class="n">WireAndDisplayPivot3</span>
<span class="k">WHERE</span> <span class="n">rowNum</span> <span class="o">=</span> <span class="o">@</span><span class="n">Iteration</span>

<span class="n">WHILE</span> <span class="o">@</span><span class="n">Iteration</span> <span class="o">&lt;=</span> <span class="o">@</span><span class="n">RowCount</span> 
<span class="k">BEGIN</span>
	<span class="k">SELECT</span> <span class="o">@</span><span class="n">OneCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">2</span>
	<span class="k">SELECT</span> <span class="o">@</span><span class="n">FourCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">4</span>
	<span class="k">SELECT</span> <span class="o">@</span><span class="n">SevenCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">3</span>
	<span class="k">SELECT</span> <span class="o">@</span><span class="n">EightCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">7</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">RightWireOne</span> <span class="o">=</span> <span class="k">LEFT</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="o">@</span><span class="n">RightWireTwo</span> <span class="o">=</span> <span class="k">RIGHT</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">2</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">MiddleAndUpperLeft</span> <span class="o">=</span> <span class="k">REPLACE</span><span class="p">(</span>
				<span class="k">REPLACE</span><span class="p">(</span>
					<span class="o">@</span><span class="n">FourCombo</span>
				<span class="p">,</span> <span class="o">@</span><span class="n">RightWireOne</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
			<span class="p">,</span> <span class="o">@</span><span class="n">RightWireTwo</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">=</span> <span class="k">LEFT</span><span class="p">(</span><span class="o">@</span><span class="n">MiddleAndUpperLeft</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="o">=</span> <span class="k">RIGHT</span><span class="p">(</span><span class="o">@</span><span class="n">MiddleAndUpperLeft</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">NineCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">6</span> 
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">RightWireOne</span> <span class="o">+</span> <span class="s1">'%'</span> 
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">RightWireTwo</span> <span class="o">+</span> <span class="s1">'%'</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">+</span> <span class="s1">'%'</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="o">+</span> <span class="s1">'%'</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">SixCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">6</span> 
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">+</span> <span class="s1">'%'</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">like</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="o">+</span> <span class="s1">'%'</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">NineCombo</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">ZeroCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">6</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">NineCombo</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">SixCombo</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">Middle</span> <span class="o">=</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="o">@</span><span class="n">ZeroCombo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">THEN</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="k">ELSE</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="k">END</span><span class="p">,</span>
		<span class="o">@</span><span class="n">UpperLeft</span> <span class="o">=</span> <span class="k">CASE</span> <span class="k">WHEN</span> <span class="o">@</span><span class="n">ZeroCombo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="o">+</span> <span class="s1">'%'</span> <span class="k">THEN</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftOne</span> <span class="k">ELSE</span> <span class="o">@</span><span class="n">MiddleOrUpperLeftTwo</span> <span class="k">END</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">FiveCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">5</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">UpperLeft</span> <span class="o">+</span> <span class="s1">'%'</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">ThreeCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">5</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">RightWireOne</span> <span class="o">+</span> <span class="s1">'%'</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="k">LIKE</span> <span class="s1">'%'</span> <span class="o">+</span> <span class="o">@</span><span class="n">RightWireTwo</span> <span class="o">+</span> <span class="s1">'%'</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">TwoCombo</span> <span class="o">=</span> <span class="n">combo</span> <span class="k">FROM</span> <span class="o">@</span><span class="n">TestSet</span> <span class="k">WHERE</span> <span class="n">comboLen</span> <span class="o">=</span> <span class="mi">5</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">FiveCombo</span>
		<span class="k">AND</span> <span class="n">combo</span> <span class="o">!=</span> <span class="o">@</span><span class="n">ThreeCombo</span>

	<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">DigitsToCombos</span>
	<span class="k">SELECT</span> <span class="n">t</span><span class="p">.</span><span class="n">digit</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="n">combo</span><span class="p">,</span> <span class="n">ca</span><span class="p">.</span><span class="n">BitSequence</span>
	<span class="k">FROM</span> <span class="p">(</span>
		<span class="k">VALUES</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">@</span><span class="n">ZeroCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">@</span><span class="n">OneCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">@</span><span class="n">TwoCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">@</span><span class="n">ThreeCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">@</span><span class="n">FourCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">@</span><span class="n">FiveCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">@</span><span class="n">SixCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">@</span><span class="n">SevenCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">@</span><span class="n">EightCombo</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="o">@</span><span class="n">NineCombo</span><span class="p">)</span>
	<span class="p">)</span> <span class="n">t</span><span class="p">(</span><span class="n">digit</span><span class="p">,</span> <span class="n">combo</span><span class="p">)</span>
	<span class="k">CROSS</span> <span class="n">APPLY</span> <span class="n">dbo</span><span class="p">.</span><span class="n">LetterToBitConverter</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">combo</span><span class="p">)</span> <span class="n">ca</span>

	<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">DigitsToSum</span> <span class="p">(</span><span class="n">rowNum</span><span class="p">,</span> <span class="n">displayNum</span><span class="p">)</span>
	<span class="k">SELECT</span> <span class="n">w</span><span class="p">.</span><span class="n">rowNum</span><span class="p">,</span> <span class="n">ca</span><span class="p">.</span><span class="n">DisplayNumber</span>
	<span class="k">FROM</span> <span class="n">DisplaysWithBits</span> <span class="n">w</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="n">a</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">BitsA</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">bits</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="n">b</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">BitsB</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">bits</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="k">c</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">BitsC</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">bits</span>
	<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">@</span><span class="n">DigitsToCombos</span> <span class="n">d</span> <span class="k">ON</span> <span class="n">w</span><span class="p">.</span><span class="n">BitsD</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">bits</span>
	<span class="k">CROSS</span> <span class="n">APPLY</span> <span class="n">dbo</span><span class="p">.</span><span class="n">DigitsToIntConverter</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">digit</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">digit</span><span class="p">,</span> <span class="k">c</span><span class="p">.</span><span class="n">digit</span><span class="p">,</span> <span class="n">d</span><span class="p">.</span><span class="n">digit</span><span class="p">)</span> <span class="n">ca</span>
	<span class="k">WHERE</span> <span class="n">w</span><span class="p">.</span><span class="n">rowNum</span> <span class="o">=</span> <span class="o">@</span><span class="n">iteration</span>

	<span class="k">DELETE</span> <span class="o">@</span><span class="n">TestSet</span>
	<span class="k">DELETE</span> <span class="o">@</span><span class="n">DigitsToCombos</span>

	<span class="k">SELECT</span> <span class="o">@</span><span class="n">iteration</span> <span class="o">=</span> <span class="o">@</span><span class="n">iteration</span> <span class="o">+</span> <span class="mi">1</span>

	<span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">TestSet</span>
	<span class="k">SELECT</span> <span class="o">*</span> 
	<span class="k">FROM</span> <span class="n">WireAndDisplayPivot3</span>
	<span class="k">WHERE</span> <span class="n">rowNum</span> <span class="o">=</span> <span class="o">@</span><span class="n">Iteration</span>
<span class="k">END</span>

<span class="k">SELECT</span> <span class="k">SUM</span><span class="p">(</span><span class="n">displayNum</span><span class="p">)</span> <span class="k">AS</span> <span class="n">TheAnswer</span>
<span class="k">FROM</span> <span class="n">DigitsToSum</span>
</code></pre></div></div>

<p>This wasn’t one of the cleanest puzzle solutions. I’m thinking I could spend some time cleaning things up and making them better but I’m more excited to move on to the other days. Maybe some other time.</p>



  <small>tags: <em>code</em> - <em>sql</em> - <em>fun</em></small>


<p>
  <div class="post-nav">
    <p>
      
      <a href="/detour/2021/12/09/day-four.html">&#8672;&nbsp;Day Four</a>
      
    </p>
    <p>
      
      <a href="/detour/2021/12/11/2d-height-map.html">2d Height Map&nbsp;&#8674;</a>
      
    </p>
  </div>
</p>
        </section>

        <footer>
        
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

      </div>
    </div>

    
  </body>
</html>