<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <title>Inventory Code</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="stylesheet" type="text/css" href="/assets/css/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="https://assumeforsimplicity.com/feed.xml" title="Assume For Simplicity" />
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Inventory Code | Assume For Simplicity</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Inventory Code" />
<meta name="author" content="jr101dallas" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Coding Stuff List of tasks is ready, time to write some code. Repeating the list here for convenience." />
<meta property="og:description" content="Coding Stuff List of tasks is ready, time to write some code. Repeating the list here for convenience." />
<link rel="canonical" href="https://assumeforsimplicity.com/roguelike/2021/11/08/inventory-code.html" />
<meta property="og:url" content="https://assumeforsimplicity.com/roguelike/2021/11/08/inventory-code.html" />
<meta property="og:site_name" content="Assume For Simplicity" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-08T09:11:34+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Inventory Code" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"jr101dallas"},"description":"Coding Stuff List of tasks is ready, time to write some code. Repeating the list here for convenience.","url":"https://assumeforsimplicity.com/roguelike/2021/11/08/inventory-code.html","@type":"BlogPosting","headline":"Inventory Code","dateModified":"2021-11-08T09:11:34+00:00","datePublished":"2021-11-08T09:11:34+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://assumeforsimplicity.com/roguelike/2021/11/08/inventory-code.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <div id="container">
      <div class="inner">
        <nav>
    
      <a href="/" >
        Home
      </a>
    
      <a href="/posts/" >
        Posts
      </a>
    
      <a href="/breadcrumbs/" >
        Breadcrumbs
      </a>
    
      <a href="/roguelike-tutorial/" >
        Roguelike
      </a>
    
      <a href="/about/" >
        About
      </a>
    
  </nav>
        <header>
          <h1>Inventory Code</h1>
          <h2>Manage Time, Software, and Business, Easily  </h2>
        </header>
        <section id="downloads" class="clearfix">
          
	
        </section>
        <hr>
        <section id="main_content">
          <p class="view">8 November 2021 by jr101dallas</p>
<a href="/posts/">&#8672;&nbsp;Back to Posts</a>


<h1 id="coding-stuff">Coding Stuff</h1>
<p>List of tasks is ready, time to write some code. Repeating the list here for convenience.</p>

<ol>
  <li>create IItem interface</li>
  <li>create Item class</li>
  <li>create Inventory class implementing IComponent</li>
  <li>add Dictionary to Inventory, key as int to start and value as IItem</li>
  <li>hardcode Item instance add to Inventory in Inventory constructor for now</li>
  <li>create Inventory in EntityFactory and add to Entity instance for now</li>
</ol>

<p>And, away we go!</p>

<h2 id="interface-and-class">Interface and Class</h2>
<p>And a test, of course. Still at the early stage of the game, and still creating empty interfaces. Yeah, it feels a little unncessary but it’s part of the expected long term strategy and hardly takes any time so I’m going ahead. It’s little enough work and close enough to the expected design that I don’t count it as <a href="https://blog.codinghorror.com/gold-plating/">gold plating</a>.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IItem</span>
    <span class="p">{</span>  
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Item</span> <span class="p">:</span> <span class="n">IItem</span>
    <span class="p">{</span>        
    <span class="p">}</span>

        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">DefaultItemIsIItem</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">item</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Item</span><span class="p">();</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsTrue</span><span class="p">(</span><span class="n">item</span> <span class="k">is</span> <span class="n">IItem</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div></div>

<h2 id="inventory-and-dictionary">Inventory and Dictionary</h2>
<p>Stealing existing code speeds this along. Copy Aim, replace the BaseAim line with the Dictionary, then I can just slap in a constructor and an Add to get an Item into the Dictionary. For tests, I can grab the contents of the ComponentTests and rename to start, but inventory has a Dictionary like Entity, so I can also grab a copy of the components test from EntityTests. Initially, the items (formerly components) test fails because I’ve hardcoded the Add for an Item in Inventory, so I can update the expected count in the test to reflect the current reality.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">public</span> <span class="k">class</span> <span class="nc">Inventory</span> <span class="p">:</span> <span class="n">IComponent</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">IItem</span><span class="p">&gt;</span> <span class="n">items</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">IItem</span><span class="p">&gt;();</span>

        <span class="k">public</span> <span class="nf">Inventory</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="k">new</span> <span class="nf">Item</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>

        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">DefaultInventoryIsIComponent</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">inventory</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Inventory</span><span class="p">();</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">IsTrue</span><span class="p">(</span><span class="n">inventory</span> <span class="k">is</span> <span class="n">IComponent</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">DefaultInventoryHasOneItem</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">inventory</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Inventory</span><span class="p">();</span>
            <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">inventory</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">Count</span><span class="p">,</span> <span class="s">"Expected a single hardcoded Item in Inventory constructor."</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div></div>

<h2 id="entity-inventory">Entity Inventory</h2>
<p>More hardcoding here for now. Every Entity has Aim; Every Entity has Inventory. The test is a copy of the test that checks that an Aim component is added to Entity by default. Remember that these tests are to explicitly state the current code shape and detect when we change things. If we end up with failing tests that we expected to fail, that’s good, the tests are doing their job. If we end up with failing tests later when we didn’t expect it, then they’re still doing their job because they’re letting us know what dominoes we’re knocking over while we work.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">public</span> <span class="n">Entity</span> <span class="nf">GetEntity</span><span class="p">(</span><span class="kt">int</span> <span class="n">lastEntityId</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">newEntityId</span> <span class="p">=</span> <span class="p">++</span><span class="n">lastEntityId</span><span class="p">;</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Entity </span><span class="p">{</span><span class="n">newEntityId</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()}</span><span class="s"> has entered play!"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">newEntity</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Entity</span><span class="p">(){</span><span class="n">Id</span> <span class="p">=</span> <span class="n">newEntityId</span><span class="p">};</span>
            <span class="n">newEntity</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Aim"</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Aim</span><span class="p">());</span>
            <span class="n">newEntity</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Inventory"</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Inventory</span><span class="p">());</span>
            <span class="k">return</span> <span class="n">newEntity</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">GetEntityDefaultsInventoryComponent</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">ef</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">EntityFactory</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">entity</span> <span class="p">=</span> <span class="n">ef</span><span class="p">.</span><span class="nf">GetEntity</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">entity</span><span class="p">.</span><span class="n">components</span><span class="p">.</span><span class="nf">TryGetValue</span><span class="p">(</span><span class="s">"Inventory"</span><span class="p">,</span> <span class="k">out</span> <span class="kt">var</span> <span class="n">defaultInventory</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Physics</span><span class="p">.</span><span class="n">Components</span><span class="p">.</span><span class="n">Inventory</span><span class="p">),</span> <span class="n">defaultInventory</span><span class="p">.</span><span class="nf">GetType</span><span class="p">());</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">Assert</span><span class="p">.</span><span class="nf">Fail</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
</code></pre></div></div>

<p>And that brings us to the end of the work item. Time for the <code class="language-plaintext highlighter-rouge">dotnet test</code> and <code class="language-plaintext highlighter-rouge">git status</code> dance! All the files are saved. Tests pass. Added and modified files list looks right. Commit, push, and go, go, go!</p>



  <small>tags: <em>code</em> - <em>inventory</em> - <em>component</em></small>


<p>
  <div class="post-nav">
    <p>
      
      <a href="/roguelike/2021/11/07/inventory.html">&#8672;&nbsp;Inventory</a>
      
    </p>
    <p>
      
      <a href="/roguelike/2021/11/09/item-aim-bonus.html">Item Aim Bonus&nbsp;&#8674;</a>
      
    </p>
  </div>
</p>
        </section>

        <footer>
        
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
        </footer>

      </div>
    </div>

    
  </body>
</html>